<!DOCTYPE html>
<html lang="ko"
      xmlns:th="http://www.thymeleaf.org"
      xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
      layout:decorate="~{/layouts/admin_layout}">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>음악 데이터 관리</title>
    <th:block th:replace="~{fragments/link::admin}"></th:block>
</head>
<th:block layout:fragment="content">
<body class="bg-dark text-light">
<main class="py-5 bg-resonos-dark">
  <div class="container" style="max-width: 1200px;">
    <h2 class="mb-4 text-light-gold">음악 데이터 관리</h2>
    <ul class="nav nav-tabs mb-4" id="musicTab" role="tablist">
      <li class="nav-item" role="presentation">
        <button class="nav-link active" id="track-tab" data-bs-toggle="tab" data-bs-target="#track" type="button" role="tab">트랙</button>
      </li>
      <li class="nav-item" role="presentation">
        <button class="nav-link" id="album-tab" data-bs-toggle="tab" data-bs-target="#album" type="button" role="tab">앨범</button>
      </li>
      <li class="nav-item" role="presentation">
        <button class="nav-link" id="artist-tab" data-bs-toggle="tab" data-bs-target="#artist" type="button" role="tab">아티스트</button>
      </li>
    </ul>
    <div class="tab-content" id="musicTabContent">
      <!-- 트랙 관리 -->
      <div class="tab-pane fade show active" id="track" role="tabpanel">
        <div class="d-flex justify-content-between mb-2">
          <h4>트랙 목록</h4>
          <a class="btn btn-gold btn-sm" data-bs-toggle="collapse" href="#trackCreateForm" role="button" aria-expanded="false" aria-controls="trackCreateForm">+ 트랙 추가</a>
        </div>
        <div class="collapse mb-4" id="trackCreateForm">
          <form th:action="@{/admin/music/track/save}" method="post" class="border rounded p-3 bg-dark">
            <div class="row g-2">
              <div class="col-md-3"><input type="text" class="form-control" name="id" placeholder="ID" required></div>
              <div class="col-md-3"><input type="text" class="form-control" name="title" placeholder="제목" required></div>
              <div class="col-md-2"><input type="text" class="form-control" name="genre" placeholder="장르"></div>
              <div class="col-md-2"><input type="text" class="form-control" name="albumId" placeholder="앨범ID"></div>
              <div class="col-md-2"><input type="text" class="form-control" name="artistId" placeholder="아티스트ID"></div>
              <div class="col-md-1"><input type="number" class="form-control" name="duration" placeholder="재생시간"></div>
              <div class="col-md-1"><input type="number" class="form-control" name="popularity" placeholder="인기"></div>
              <div class="col-md-1"><input type="number" class="form-control" name="trackNo" placeholder="트랙번호"></div>
            </div>
            <div class="text-end mt-2">
              <button class="btn btn-gold btn-sm" type="submit">저장</button>
              <a class="btn btn-outline-secondary btn-sm ms-2" data-bs-toggle="collapse" href="#trackCreateForm">취소</a>
            </div>
          </form>
        </div>
        <div class="resonos-card p-3">
          <table class="table table-dark table-hover align-middle resonos-table">
            <thead>
              <tr>
                <th>ID</th>
                <th>제목</th>
                <th>장르</th>
                <th>앨범</th>
                <th>아티스트</th>
                <th>재생시간</th>
                <th>인기</th>
                <th>관리</th>
              </tr>
            </thead>
            <tbody>
              <tr th:each="track, iterStat : ${tracks}">
                <td th:text="${track.id}">id</td>
                <td th:text="${track.title}">제목</td>
                <td th:text="${track.genre}">장르</td>
                <td th:text="${track.albumId}">앨범</td>
                <td th:text="${track.artistId}">아티스트</td>
                <td th:text="${track.duration}">0</td>
                <td th:text="${track.popularity}">0</td>
                <td>
                  <a class="btn btn-outline-gold btn-sm" data-bs-toggle="collapse" th:href="'#__editTrack' + ${track.id}" role="button">수정</a>
                  <form th:action="@{/admin/music/track/delete}" method="post" style="display:inline;">
                    <input type="hidden" name="id" th:value="${track.id}" />
                    <button class="btn btn-outline-gold btn-sm" type="submit" onclick="return confirm('삭제하시겠습니까?')">삭제</button>
                  </form>
                </td>
              </tr>
              <tr th:each="track : ${tracks}" th:id="'__editTrack' + ${track.id}" class="collapse">
                <td colspan="8">
                  <form th:action="@{/admin/music/track/save}" method="post" class="border rounded p-3 bg-dark">
                    <input type="hidden" name="id" th:value="${track.id}" />
                    <div class="row g-2">
                      <div class="col-md-3"><input type="text" class="form-control" name="title" th:value="${track.title}" required></div>
                      <div class="col-md-2"><input type="text" class="form-control" name="genre" th:value="${track.genre}"></div>
                      <div class="col-md-2"><input type="text" class="form-control" name="albumId" th:value="${track.albumId}"></div>
                      <div class="col-md-2"><input type="text" class="form-control" name="artistId" th:value="${track.artistId}"></div>
                      <div class="col-md-1"><input type="number" class="form-control" name="duration" th:value="${track.duration}"></div>
                      <div class="col-md-1"><input type="number" class="form-control" name="popularity" th:value="${track.popularity}"></div>
                      <div class="col-md-1"><input type="number" class="form-control" name="trackNo" th:value="${track.trackNo}"></div>
                    </div>
                    <div class="text-end mt-2">
                      <button class="btn btn-gold btn-sm" type="submit">저장</button>
                      <a class="btn btn-outline-secondary btn-sm ms-2" data-bs-toggle="collapse" th:href="'#__editTrack' + ${track.id}">취소</a>
                    </div>
                  </form>
                </td>
              </tr>
              <tr th:if="${#lists.isEmpty(tracks)}">
                <td colspan="8" class="text-center text-secondary">등록된 트랙이 없습니다.</td>
              </tr>
            </tbody>
          </table>
        </div>
      </div>
      <!-- 앨범 관리 -->
      <div class="tab-pane fade" id="album" role="tabpanel">
        <div class="d-flex justify-content-between mb-2">
          <h4>앨범 목록</h4>
          <a class="btn btn-gold btn-sm" data-bs-toggle="collapse" href="#albumCreateForm" role="button" aria-expanded="false" aria-controls="albumCreateForm">+ 앨범 추가</a>
        </div>
        <div class="collapse mb-4" id="albumCreateForm">
          <form th:action="@{/admin/music/album/save}" method="post" class="border rounded p-3 bg-dark">
            <div class="row g-2">
              <div class="col-md-2"><input type="text" class="form-control" name="id" placeholder="ID" required></div>
              <div class="col-md-2"><input type="text" class="form-control" name="title" placeholder="제목" required></div>
              <div class="col-md-2"><input type="text" class="form-control" name="coverImage" placeholder="커버이미지 URL"></div>
              <div class="col-md-2"><input type="date" class="form-control" name="releaseDate" placeholder="발매일"></div>
              <div class="col-md-1"><input type="text" class="form-control" name="genre" placeholder="장르"></div>
              <div class="col-md-1"><input type="text" class="form-control" name="label" placeholder="레이블"></div>
              <div class="col-md-2"><input type="text" class="form-control" name="description" placeholder="설명"></div>
              <div class="col-md-2"><input type="text" class="form-control" name="artistId" placeholder="아티스트ID"></div>
            </div>
            <div class="text-end mt-2">
              <button class="btn btn-gold btn-sm" type="submit">저장</button>
              <a class="btn btn-outline-secondary btn-sm ms-2" data-bs-toggle="collapse" href="#albumCreateForm">취소</a>
            </div>
          </form>
        </div>
        <div class="resonos-card p-3">
          <table class="table table-dark table-hover align-middle resonos-table">
            <thead>
              <tr>
                <th>ID</th>
                <th>제목</th>
                <th>커버</th>
                <th>발매일</th>
                <th>장르</th>
                <th>레이블</th>
                <th>설명</th>
                <th>아티스트</th>
                <th>관리</th>
              </tr>
            </thead>
            <tbody>
              <tr th:each="album, iterStat : ${albums}">
                <td th:text="${album.id}">id</td>
                <td th:text="${album.title}">제목</td>
                <td><img th:src="${album.coverImage}" style="width:38px;height:38px;border-radius:8px;object-fit:cover;"></td>
                <td th:text="${#dates.format(album.releaseDate, 'yyyy-MM-dd')}">발매일</td>
                <td th:text="${album.genre}">장르</td>
                <td th:text="${album.label}">레이블</td>
                <td th:text="${album.description}">설명</td>
                <td th:text="${album.artistId}">아티스트</td>
                <td>
                  <a class="btn btn-outline-gold btn-sm" data-bs-toggle="collapse" th:href="'#__editAlbum' + ${album.id}" role="button">수정</a>
                  <form th:action="@{/admin/music/album/delete}" method="post" style="display:inline;">
                    <input type="hidden" name="id" th:value="${album.id}" />
                    <button class="btn btn-outline-gold btn-sm" type="submit" onclick="return confirm('삭제하시겠습니까?')">삭제</button>
                  </form>
                </td>
              </tr>
              <tr th:each="album : ${albums}" th:id="'__editAlbum' + ${album.id}" class="collapse">
                <td colspan="9">
                  <form th:action="@{/admin/music/album/save}" method="post" class="border rounded p-3 bg-dark">
                    <input type="hidden" name="id" th:value="${album.id}" />
                    <div class="row g-2">
                      <div class="col-md-2"><input type="text" class="form-control" name="title" th:value="${album.title}" required></div>
                      <div class="col-md-2"><input type="text" class="form-control" name="coverImage" th:value="${album.coverImage}"></div>
                      <div class="col-md-2"><input type="date" class="form-control" name="releaseDate" th:value="${#dates.format(album.releaseDate, 'yyyy-MM-dd')}"></div>
                      <div class="col-md-1"><input type="text" class="form-control" name="genre" th:value="${album.genre}"></div>
                      <div class="col-md-1"><input type="text" class="form-control" name="label" th:value="${album.label}"></div>
                      <div class="col-md-2"><input type="text" class="form-control" name="description" th:value="${album.description}"></div>
                      <div class="col-md-2"><input type="text" class="form-control" name="artistId" th:value="${album.artistId}"></div>
                    </div>
                    <div class="text-end mt-2">
                      <button class="btn btn-gold btn-sm" type="submit">저장</button>
                      <a class="btn btn-outline-secondary btn-sm ms-2" data-bs-toggle="collapse" th:href="'#__editAlbum' + ${album.id}">취소</a>
                    </div>
                  </form>
                </td>
              </tr>
              <tr th:if="${#lists.isEmpty(albums)}">
                <td colspan="9" class="text-center text-secondary">등록된 앨범이 없습니다.</td>
              </tr>
            </tbody>
          </table>
        </div>
      </div>
      <!-- 아티스트 관리 -->
      <div class="tab-pane fade" id="artist" role="tabpanel">
        <div class="d-flex justify-content-between mb-2">
          <h4>아티스트 목록</h4>
          <a class="btn btn-gold btn-sm" data-bs-toggle="collapse" href="#artistCreateForm" role="button" aria-expanded="false" aria-controls="artistCreateForm">+ 아티스트 추가</a>
        </div>
        <div class="collapse mb-4" id="artistCreateForm">
          <form th:action="@{/admin/music/artist/save}" method="post" class="border rounded p-3 bg-dark">
            <div class="row g-2">
              <div class="col-md-3"><input type="text" class="form-control" name="id" placeholder="ID" required></div>
              <div class="col-md-3"><input type="text" class="form-control" name="name" placeholder="이름" required></div>
              <div class="col-md-4"><input type="text" class="form-control" name="profileImage" placeholder="프로필 이미지 URL"></div>
              <div class="col-md-2"><input type="text" class="form-control" name="genres" placeholder="장르"></div>
            </div>
            <div class="text-end mt-2">
              <button class="btn btn-gold btn-sm" type="submit">저장</button>
              <a class="btn btn-outline-secondary btn-sm ms-2" data-bs-toggle="collapse" href="#artistCreateForm">취소</a>
            </div>
          </form>
        </div>
        <div class="resonos-card p-3">
          <table class="table table-dark table-hover align-middle resonos-table">
            <thead>
              <tr>
                <th>ID</th>
                <th>이름</th>
                <th>프로필</th>
                <th>장르</th>
                <th>관리</th>
              </tr>
            </thead>
            <tbody>
              <tr th:each="artist, iterStat : ${artists}">
                <td th:text="${artist.id}">id</td>
                <td th:text="${artist.name}">이름</td>
                <td><img th:src="${artist.profileImage}" style="width:38px;height:38px;border-radius:50%;object-fit:cover;"></td>
                <td th:text="${artist.genres}">장르</td>
                <td>
                  <a class="btn btn-outline-gold btn-sm" data-bs-toggle="collapse" th:href="'#__editArtist' + ${artist.id}" role="button">수정</a>
                  <form th:action="@{/admin/music/artist/delete}" method="post" style="display:inline;">
                    <input type="hidden" name="id" th:value="${artist.id}" />
                    <button class="btn btn-outline-gold btn-sm" type="submit" onclick="return confirm('삭제하시겠습니까?')">삭제</button>
                  </form>
                </td>
              </tr>
              <tr th:each="artist : ${artists}" th:id="'__editArtist' + ${artist.id}" class="collapse">
                <td colspan="5">
                  <form th:action="@{/admin/music/artist/save}" method="post" class="border rounded p-3 bg-dark">
                    <input type="hidden" name="id" th:value="${artist.id}" />
                    <div class="row g-2">
                      <div class="col-md-3"><input type="text" class="form-control" name="name" th:value="${artist.name}" required></div>
                      <div class="col-md-4"><input type="text" class="form-control" name="profileImage" th:value="${artist.profileImage}"></div>
                      <div class="col-md-4"><input type="text" class="form-control" name="genres" th:value="${artist.genres}"></div>
                    </div>
                    <div class="text-end mt-2">
                      <button class="btn btn-gold btn-sm" type="submit">저장</button>
                      <a class="btn btn-outline-secondary btn-sm ms-2" data-bs-toggle="collapse" th:href="'#__editArtist' + ${artist.id}">취소</a>
                    </div>
                  </form>
                </td>
              </tr>
              <tr th:if="${#lists.isEmpty(artists)}">
                <td colspan="5" class="text-center text-secondary">등록된 아티스트가 없습니다.</td>
              </tr>
            </tbody>
          </table>
        </div>
    </div>
    <!-- 트랙/앨범/아티스트 등록/수정 모달 (폼은 필요에 따라 구현) -->
    <!-- ...모달 폼 생략(추후 구현)... -->
  </div>
</main>
</body>
</th:block>
</html>
